*** Settings ***
Library           SeleniumLibrary
Library           Process
Library           OperatingSystem

*** Variables ***
${PROJECT_PATH}    C:/GOBI/FCL/webapi_fioscl_v2.dvr.get/vz.fioscl.dvr.get.csproj
${TARGET_FRAMEWORK}    net8.0

*** Test Cases ***
Automate Upgrade Assistant
    Log To Console    Starting upgrade-assistant automation...
    
    # Run the upgrade-assistant command
    ${process}=    Run Process    powershell.exe    -ArgumentList upgrade-assistant upgrade "${PROJECT_PATH}" --target-framework "${TARGET_FRAMEWORK}"    shell=True

    # Wait for the upgrade-assistant prompt
    Sleep    5s

    # Simulate selecting the "In-place project upgrade" option
    Log To Console    Simulating key presses...
    Simulate Key Press    {DOWN}
    Sleep    1s
    Simulate Key Press    {ENTER}

    # Verify the result of the process
    ${return_code}=    Get Process Result    ${process}
    Run Keyword If    '${return_code}' == '0'    Log To Console    Upgrade completed successfully!
    Run Keyword If    '${return_code}' != '0'    Fail    Upgrade failed!
